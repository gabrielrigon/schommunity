$ ->
  window.SubjectDataTable = $("#classrooms").dataTable(
    sDom: "<'row'<'col-md-6'l><'col-md-6'f>r>t<'row'<'col-md-6'i><'col-md-6'p>>"
    bProcessing: true
    bServerSide: true
    sAjaxSource: $("#classrooms").data("source")
    fnServerData: (sSource, aaData, fnCallback) ->
      $.getJSON sSource, aaData, (json) ->
        fnCallback json

    oLanguage:
      sEmptyTable: "Nenhum registro encontrado"
      sInfo: "Mostrando de _START_ até _END_ de _TOTAL_ registros"
      sInfoEmpty: "Mostrando 0 até 0 de 0 registros"
      sInfoFiltered: "(Filtrados de _MAX_ registros)"
      sInfoPostFix: ""
      sInfoThousands: "."
      sLengthMenu: "_MENU_ resultados por página"
      sLoadingRecords: "Carregando..."
      sProcessing: "Processando..."
      sZeroRecords: "Nenhum registro encontrado"
      sSearch: "Pesquisar"
      oPaginate:
          sNext: "Próximo"
          sPrevious: "Anterior"
          sFirst: "Primeiro"
          sLast: "Último"
      oAria:
          sSortAscending: ": Ordenar colunas de forma ascendente"
          sSortDescending: ": Ordenar colunas de forma descendente"

    aoColumnDefs: [
      bSortable: false
      aTargets: [5]
    ]

    fnRowCallback: (nRow, aData, iDisplayIndex, iDisplayIndexFull) ->
      $("td:eq(5)", nRow).addClass "text-center"

    bAutoWidth: false
  )

  # dependent selectize to subjects

  $('.selectize-course').on 'change', ->
    $('#classroom_subject_id').selectize()[0].selectize.destroy()
    $('#classroom_subject_id').val('')

    if $(this).val() != ""
      course_id = $(this).val()
      subject_url = "/teachers/classrooms/subject_field/?course_id=#{course_id}"

      $('#subject_container').empty()
      $('#subject_container').load subject_url, ->
        $('.selectize-subject').selectize({ create: false })
    else
      $('.selectize-subject').selectize({ create: false })
